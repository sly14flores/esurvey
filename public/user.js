(window.webpackJsonp=window.webpackJsonp||[]).push([[14,10],{"7R6G":function(e,t,s){"use strict";s.r(t);var i={props:["isList"]},r=s("KHd+"),a=Object(r.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-header"},[s("div",{staticClass:"row align-items-end"},[e._m(0),e._v(" "),s("div",{staticClass:"col-lg-4"},[s("div",{staticClass:"page-header-breadcrumb"},[s("ul",{staticClass:"breadcrumb-title"},[s("li",{staticClass:"breadcrumb-item"},[s("router-link",{attrs:{to:"/dashboard"}},[s("i",{staticClass:"feather icon-home"})])],1),e._v(" "),e._m(1)])])])]),e._v(" "),e.isList?s("div",{staticClass:"row align-items-end"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticStyle:{"margin-top":"20px"}},[s("router-link",{staticClass:"btn btn-primary btn-sm",attrs:{to:"/user",tag:"button"}},[e._v("Add")])],1)])]):e._e()])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-lg-8"},[t("div",{staticClass:"page-header-title"},[t("div",{staticClass:"d-inline"},[t("h4",[this._v("Manage Users")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",{staticClass:"breadcrumb-item"},[t("a",{attrs:{href:"javascript:;"}},[this._v("Users")])])}],!1,null,null,null);t.default=a.exports},XSSm:function(e,t,s){"use strict";s.r(t);var i=s("ta7f"),r={name:"UserForm",components:{UsersHeader:s("7R6G").default},data:function(){return{onEdit:!1,usernameTaken:!1,offices:[],groups:[]}},computed:{user:{get:function(){return this.$store.state.users.user},set:function(e){this.$store.commit("users/user",e)}},oldUser:function(){return this.$route.params.hasOwnProperty("user_id")}},watch:{"user.username":function(e,t){var s=this;""!=e?this.oldUser?this.usernameTaken=!1:axios.post("username",{username:e}).then((function(e){s.usernameTaken=e.data.taken})):this.usernameTaken=!1}},validations:{user:{firstname:{required:i.required},lastname:{required:i.required},email:{required:i.required,email:i.email},username:{required:i.required},office:{required:i.required},group:{required:i.required}}},methods:{fetchUser:function(e){var t=this;axios.get("api/user/"+e,this.$store.state.config).then((function(e){t.$store.commit("users/user",e.data.data)})).catch((function(e){t.$router.push({name:"users_list"})}))},confirmAdd:function(){this.$v.user.$touch(),this.$v.user.$invalid||this.usernameIsTaken()||this.$refs["confirm-add"].show()},save:function(){var e=this;this.$root.show(),axios.post("api/user",this.user,this.$store.state.config).then((function(t){e.$root.hide(),e.$router.push({name:"users_list"}),e.$parent.$refs.pnotify.show({type:"success",title:"Notification",text:"New user successfully added"})})).catch((function(t){e.$root.hide(),403==t.response.status&&e.$parent.$refs.pnotify.show({type:"error",title:"Notification",text:t.response.data.message})}))},edit:function(){this.onEdit=!this.onEdit},confirmUpdate:function(){this.$v.user.$touch(),this.$v.user.$invalid||this.usernameIsTaken()||this.$refs["confirm-update"].show()},update:function(){var e=this;this.$root.show(),axios.put("api/user/"+this.user.id,this.user,this.$store.state.config).then((function(t){e.onEdit=!1,e.$root.hide(),e.$parent.$refs.pnotify.show({type:"success",title:"Notification",text:"User's info successfully updated"})})).catch((function(t){e.$root.hide(),403==t.response.status&&e.$parent.$refs.pnotify.show({type:"error",title:"Notification",text:t.response.data.message})}))},close:function(){this.$store.commit("users/user",{}),this.$router.push({name:"users_list"})},confirmDelete:function(){this.$refs["confirm-delete"].show()},deleteUser:function(){var e=this;this.$root.show(),axios.delete("api/user/"+this.$store.state.users.user.id,this.$store.state.config).then((function(t){e.$root.hide(),e.$parent.$refs.pnotify.show({type:"success",title:"Notification",text:"User info successfully deleted"}),e.$router.push({name:"users_list"})})).catch((function(t){e.$root.hide(),403==t.response.status&&e.$parent.$refs.pnotify.show({type:"error",title:"Notification",text:t.response.data.message})}))},usernameIsTaken:function(){return this.usernameTaken&&this.$parent.$refs.pnotify.show({type:"danger",title:"Notification",text:"Username is already taken"}),this.usernameTaken},fetchOffices:function(){var e=this;axios.get("api/selections/offices",this.$store.state.config).then((function(t){e.offices=t.data})).catch((function(e){}))},fetchGroups:function(){var e=this;axios.get("api/selections/groups",this.$store.state.config).then((function(t){e.groups=t.data})).catch((function(e){}))}},created:function(){this.fetchOffices(),this.fetchGroups()},mounted:function(){var e=this;this.$nextTick((function(){e.oldUser||(e.onEdit=!0)}))},beforeRouteEnter:function(e,t,s){s((function(e){var s="/"==t.fullPath;e.$route.params.hasOwnProperty("user_id")?s?e.$store.dispatch("api_token").then((function(){e.fetchUser(e.$route.params.user_id)})):e.fetchUser(e.$route.params.user_id):e.$store.commit("users/user",{})}))}},a=s("KHd+"),o=Object(a.a)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"page-wrapper"},[s("users-header",{attrs:{isList:!1}}),e._v(" "),s("div",{staticClass:"page-body"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[s("h5",[e._v("User Form")]),e._v(" "),s("form",{staticClass:"f-right"},[s("div",{staticClass:"right-icon-control"},[e.oldUser?s("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:e.edit}},[e._v(e._s(e.onEdit?"Cancel":"Edit"))]):e._e(),e._v(" "),e.oldUser?s("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:e.confirmDelete}},[e._v("Delete")]):e._e()])])]),e._v(" "),s("div",{staticClass:"card-block"},[s("form",{staticClass:"needs-validation",attrs:{novalidate:""}},[s("div",{staticClass:"form-row"},[s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("First name")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.$v.user.firstname.$model,expression:"$v.user.firstname.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":e.$v.user.firstname.$error},attrs:{type:"text",disabled:e.oldUser&&!e.onEdit},domProps:{value:e.$v.user.firstname.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.user.firstname,"$model",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),s("div",{staticClass:"invalid-feedback"},[e._v("First name is required")])]),e._v(" "),s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("Middle name")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.middlename,expression:"user.middlename"}],staticClass:"form-control",attrs:{type:"text",disabled:e.oldUser&&!e.onEdit},domProps:{value:e.user.middlename},on:{input:function(t){t.target.composing||e.$set(e.user,"middlename",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("Last name")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.$v.user.lastname.$model,expression:"$v.user.lastname.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":e.$v.user.lastname.$error},attrs:{type:"text",disabled:e.oldUser&&!e.onEdit},domProps:{value:e.$v.user.lastname.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.user.lastname,"$model",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),s("div",{staticClass:"invalid-feedback"},[e._v("Last name is required")])])]),e._v(" "),s("div",{staticClass:"form-row"},[s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("Email")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.$v.user.email.$model,expression:"$v.user.email.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":e.$v.user.email.$error},attrs:{type:"email",disabled:e.oldUser&&!e.onEdit},domProps:{value:e.$v.user.email.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.user.email,"$model",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),s("div",{staticClass:"invalid-feedback"},[e._v("Valid email address is required")])]),e._v(" "),s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("Username")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.$v.user.username.$model,expression:"$v.user.username.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":e.$v.user.username.$error||e.usernameTaken},attrs:{type:"text",disabled:e.oldUser&&!e.onEdit},domProps:{value:e.$v.user.username.$model},on:{input:function(t){t.target.composing||e.$set(e.$v.user.username,"$model",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),s("div",{staticClass:"invalid-feedback",attrs:{"ng-if":"$v.user.username.$error || usernameTaken"}},[e._v(e._s(e.$v.user.username.$error?"Username is required":"")+" "+e._s(e.usernameTaken?"Username is taken":""))]),e._v(" "),s("div",{staticClass:"invalid-feedback",attrs:{"ng-if":"usernameTaken"}})]),e._v(" "),s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("Office")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.$v.user.office.$model,expression:"$v.user.office.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":e.$v.user.office.$error},attrs:{disabled:e.oldUser&&!e.onEdit},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.$v.user.office,"$model",t.target.multiple?s:s[0])}}},[s("option",{attrs:{disabled:""},domProps:{value:null}},[e._v("Select office")]),e._v(" "),e._l(e.offices,(function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.name))])}))],2),e._v(" "),s("div",{staticClass:"invalid-feedback"},[e._v("Office is required")])])]),e._v(" "),s("div",{staticClass:"form-row"},[s("div",{staticClass:"form-group col-lg-4"},[s("label",[e._v("Group")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.$v.user.group.$model,expression:"$v.user.group.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":e.$v.user.group.$error},attrs:{disabled:e.oldUser&&!e.onEdit},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.$v.user.group,"$model",t.target.multiple?s:s[0])}}},[s("option",{attrs:{disabled:""},domProps:{value:null}},[e._v("Select group")]),e._v(" "),e._l(e.groups,(function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.name))])}))],2),e._v(" "),s("div",{staticClass:"invalid-feedback"},[e._v("Group is required")])])]),e._v(" "),s("div",{staticClass:"f-right"},[e.oldUser?e._e():s("button",{staticClass:"btn btn-info btn-sm",attrs:{type:"button"},on:{click:e.confirmAdd}},[e._v("Save")]),e._v(" "),e.oldUser?s("button",{staticClass:"btn btn-info btn-sm",attrs:{type:"button",disabled:!e.onEdit},on:{click:e.confirmUpdate}},[e._v("Update")]):e._e(),e._v(" "),s("button",{staticClass:"btn btn-warning btn-sm",attrs:{type:"button"},on:{click:e.close}},[e._v(e._s(e.oldUser?"Close":"Cancel"))])])])])])])],1),e._v(" "),s("b-modal",{ref:"confirm-add",attrs:{title:"Confirmation"},on:{ok:e.save}},[e._v("\n\t\tConfirm user add?\n\t")]),e._v(" "),s("b-modal",{ref:"confirm-update",attrs:{title:"Confirmation"},on:{ok:e.update}},[e._v("\n\t\tAre you sure you want to update this user's info?\n\t")]),e._v(" "),s("b-modal",{ref:"confirm-delete",attrs:{title:"Confirmation"},on:{ok:e.deleteUser}},[e._v("\n\t\tAre you sure you want to delete this user?\n\t")])],1)}),[],!1,null,null,null);t.default=o.exports}}]);