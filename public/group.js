(window.webpackJsonp=window.webpackJsonp||[]).push([[11,6],{eqgh:function(t,e,i){"use strict";i.r(e);var o=i("ta7f"),s=i("iVL7");function a(t,e,i){t.$set(t.$data._asyncComputed[e],"state",i),t.$set(t.$data._asyncComputed[e],"updating","updating"===i),t.$set(t.$data._asyncComputed[e],"error","error"===i),t.$set(t.$data._asyncComputed[e],"success","success"===i)}function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function r(t){return n(t,"lazy")&&t.lazy}var c="async_computed$lazy_active$",u="async_computed$lazy_data$";function l(t,e){t[c+e]=!1,t[u+e]=null}function d(t){return{get:function(){return this[c+t]=!0,this[u+t]},set:function(e){this[u+t]=e}}}function p(t,e,i){t[u+e]=i}function f(t){if("function"==typeof t.watch)return function(t){return function(){return t.watch.call(this),t.get.call(this)}}(t);if(Array.isArray(t.watch))return t.watch.forEach((function(t){if("string"!=typeof t)throw new Error("AsyncComputed: watch elemnts must be strings")})),function(t){return function(){var e=this;return t.watch.forEach((function(t){var i=t.split(".");if(1===i.length)e[t];else try{var o=e;i.forEach((function(t){o=o[t]}))}catch(e){throw console.error("AsyncComputed: bad path: ",t),e}})),t.get.call(this)}}(t);throw Error("AsyncComputed: watch should be function or an array")}var h="function"==typeof Symbol?Symbol("did-not-update"):{},v={install:function(t,e){e=e||{},t.config.optionMergeStrategies.asyncComputed=t.config.optionMergeStrategies.computed,t.mixin({data:function(){return{_asyncComputed:{}}},computed:{$asyncComputed:function(){return this.$data._asyncComputed}},beforeCreate:function(){var t=this.$options.asyncComputed||{};if(Object.keys(t).length){for(var e in t){var i=g(e,t[e]);this.$options.computed["_async_computed$"+e]=i}this.$options.data=function(t){var e=t.data,i=t.asyncComputed||{};return function(t){var o=("function"==typeof e?e.call(this,t):e)||{};for(var s in i){r(this.$options.asyncComputed[s])?(l(o,s),this.$options.computed[s]=d(s)):o[s]=null}return o}}(this.$options)}},created:function(){for(var i in this.$options.asyncComputed||{}){var o=this.$options.asyncComputed[i],s=$.call(this,o,e);r(o)?p(this,i,s):this[i]=s}for(var a in this.$options.asyncComputed||{})m(this,a,e,t)}})}};function m(t,e,i,o){var s=0,n=function(n){var r=++s;h!==n&&(n&&n.then||(n=Promise.resolve(n)),a(t,e,"updating"),n.then((function(i){r===s&&(a(t,e,"success"),t[e]=i)})).catch((function(n){if(r===s&&(a(t,e,"error"),o.set(t.$data._asyncComputed[e],"exception",n),!1!==i.errorHandler)){var c=void 0===i.errorHandler?console.error.bind(console,"Error evaluating async computed property:"):i.errorHandler;i.useRawError?c(n,t,n.stack):c(n.stack)}})))};o.set(t.$data._asyncComputed,e,{exception:null,update:function(){var i;t._isDestroyed||n((i=t.$options.asyncComputed[e],"function"==typeof i?i:i.get).apply(t))}}),a(t,e,"updating"),t.$watch("_async_computed$"+e,n,{immediate:!0})}function g(t,e){if("function"==typeof e)return e;var i,o,s=e.get;if(n(e,"watch")&&(s=f(e)),n(e,"shouldUpdate")&&(i=e,o=s,s=function(){return i.shouldUpdate.call(this)?o.call(this):h}),r(e)){var a=s;s=function(){return function(t,e){return t[c+e]}(this,t)?a.call(this):function(t,e){return t[u+e]}(this,t)}}return s}function $(t,e){var i=null;return"default"in t?i=t.default:"default"in e&&(i=e.default),"function"==typeof i?i.call(this):i}"undefined"!=typeof window&&window.Vue&&window.Vue.use(v);var _=v,y=i("XuX8"),b=i.n(y);i("L2JU");b.a.use(_);var C={name:"GroupForm",components:{GroupsHeader:s.default},data:function(){return{onEdit:!1,gatesPolicies:!1}},computed:{group:{get:function(){return this.$store.state.groups.group},set:function(t){this.$store.commit("groups/group",t)}},oldGroup:function(){return this.$route.params.hasOwnProperty("group_id")},authorizations:{get:function(){return this.$store.state.groups.group.authorizations},set:function(t){this.$store.commit("groups/authorizations",t)}}},validations:{group:{name:{required:o.required},description:{required:o.required}}},methods:{fetchGroup:function(t){var e=this;axios.get("api/group/"+t).then((function(t){e.$store.commit("groups/group",t.data.data),e.oldGroup&&(e.parentGatesPolicies(),t.data.data.authorizations.forEach((function(t){return e.parentModelGP(t)})))})).catch((function(t){}))},getGpTemplate:function(){return axios.get("api/authorizations")},confirmAdd:function(){this.$v.group.$touch(),this.$v.group.$invalid||this.$refs["confirm-add"].show()},save:function(){var t=this;this.$root.show(),axios.post("api/group",this.group,this.$store.state.config).then((function(e){t.$root.hide(),t.$router.push({name:"groups_list"}),t.$parent.$refs.pnotify.show({type:"success",title:"Notification",text:"New group successfully added"})})).catch((function(e){t.$root.hide(),403==e.response.status&&t.$parent.$refs.pnotify.show({type:"error",title:"Notification",text:e.response.data.message})}))},edit:function(){this.onEdit=!this.onEdit},confirmUpdate:function(){this.$v.group.$touch(),this.$v.group.$invalid||this.$refs["confirm-update"].show()},update:function(){var t=this;this.$root.show(),axios.put("api/group/"+this.group.id,this.group,this.$store.state.config).then((function(e){t.onEdit=!1,t.$root.hide(),t.$parent.$refs.pnotify.show({type:"success",title:"Notification",text:"Group's info successfully updated"})})).catch((function(e){t.$root.hide(),403==e.response.status&&t.$parent.$refs.pnotify.show({type:"error",title:"Notification",text:e.response.data.message})}))},close:function(){this.$store.commit("groups/group",{}),this.$router.push({name:"groups_list"})},confirmDelete:function(t){this.$refs["confirm-delete"].show()},deleteGroup:function(){var t=this;this.$root.show(),axios.delete("api/group/"+this.$store.state.groups.group.id,this.$store.state.config).then((function(e){t.$root.hide(),t.$parent.$refs.pnotify.show({type:"success",title:"Notification",text:"Group info successfully deleted"}),t.$router.push({name:"groups_list"})})).catch((function(e){t.$root.hide(),403==e.response.status&&t.$parent.$refs.pnotify.show({type:"error",title:"Notification",text:e.response.data.message})}))},parentGatesPolicies:function(){var t=!1;this.authorizations.length>0&&(t=!0),this.authorizations.forEach((function(e){t=t&&e.gates.every((function(t){return!0===t.value}))&&e.policies.every((function(t){return!0===t.value}))})),this.gatesPolicies=t},childrenGatesPolicies:function(){var t=this;this.$store.state.groups.group.authorizations.forEach((function(e){e.all=t.gatesPolicies,e.gates.forEach((function(e){return e.value=t.gatesPolicies})),e.policies.forEach((function(e){return e.value=t.gatesPolicies}))}))},parentModelGP:function(t){var e=this.authorizations.indexOf(t),i=!1;null!=this.authorizations[e]&&(i=!0),i=i&&this.authorizations[e].gates.every((function(t){return!0===t.value}))&&this.authorizations[e].policies.every((function(t){return!0===t.value})),this.authorizations[e].all=i},childrenModelGP:function(t){var e=this.authorizations.indexOf(t);this.$store.state.groups.group.authorizations[e].gates.forEach((function(e){return e.value=t.all})),this.$store.state.groups.group.authorizations[e].policies.forEach((function(e){return e.value=t.all})),this.parentGatesPolicies()},parentGP:function(t){this.parentGatesPolicies(),this.parentModelGP(t)},childrenGP:function(t){this.childrenGatesPolicies(),this.childrenModelGP(t)}},created:function(){},mounted:function(){var t=this;this.$nextTick((function(){t.oldGroup||(t.onEdit=!0)}))},beforeRouteEnter:function(t,e,i){i((function(t){e.fullPath;t.$route.params.hasOwnProperty("group_id")?t.fetchGroup(t.$route.params.group_id):(t.$store.commit("groups/group",{}),t.getGpTemplate().then((function(e){t.$store.commit("groups/authorizations",e.data)})).catch((function(t){})))}))}},w=i("KHd+"),G=Object(w.a)(C,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"page-wrapper"},[i("groups-header",{attrs:{isList:!1}}),t._v(" "),i("div",{staticClass:"page-body"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-header"},[i("h5",[t._v("Group Form")]),t._v(" "),i("form",{staticClass:"f-right"},[i("div",{staticClass:"right-icon-control"},[t.oldGroup?i("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.edit}},[t._v(t._s(t.onEdit?"Cancel":"Edit"))]):t._e(),t._v(" "),t.oldGroup?i("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:t.confirmDelete}},[t._v("Delete")]):t._e()])])]),t._v(" "),i("div",{staticClass:"card-block"},[i("form",{staticClass:"needs-validation",attrs:{novalidate:""}},[i("div",{staticClass:"form-row"},[i("div",{staticClass:"form-group col-lg-6"},[i("label",[t._v("Name")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.$v.group.name.$model,expression:"$v.group.name.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":t.$v.group.name.$error},attrs:{type:"text",disabled:t.oldGroup&&!t.onEdit},domProps:{value:t.$v.group.name.$model},on:{input:function(e){e.target.composing||t.$set(t.$v.group.name,"$model",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),i("div",{staticClass:"invalid-feedback"},[t._v("Name is required")])]),t._v(" "),i("div",{staticClass:"form-group col-lg-6"},[i("label",[t._v("Description")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.$v.group.description.$model,expression:"$v.group.description.$model",modifiers:{trim:!0}}],staticClass:"form-control",class:{"is-invalid":t.$v.group.description.$error},attrs:{type:"text",disabled:t.oldGroup&&!t.onEdit},domProps:{value:t.$v.group.description.$model},on:{input:function(e){e.target.composing||t.$set(t.$v.group.description,"$model",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),i("div",{staticClass:"invalid-feedback"},[t._v("Description is required")])])]),t._v(" "),i("hr"),t._v(" "),i("h5",{staticClass:"m-b-20"},[i("div",{staticClass:"checkbox-fade fade-in-warning"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.gatesPolicies,expression:"gatesPolicies"}],attrs:{type:"checkbox",disabled:t.oldGroup&&!t.onEdit},domProps:{checked:Array.isArray(t.gatesPolicies)?t._i(t.gatesPolicies,null)>-1:t.gatesPolicies},on:{change:[function(e){var i=t.gatesPolicies,o=e.target,s=!!o.checked;if(Array.isArray(i)){var a=t._i(i,null);o.checked?a<0&&(t.gatesPolicies=i.concat([null])):a>-1&&(t.gatesPolicies=i.slice(0,a).concat(i.slice(a+1)))}else t.gatesPolicies=s},t.childrenGatesPolicies]}}),t._v(" "),t._m(0),t._v(" "),i("span",[t._v(" Gates and Policies")])])])]),t._v(" "),t._l(t.authorizations,(function(e){return i("div",{key:e.model,staticClass:"m-b-30"},[i("h5",[i("div",{staticClass:"checkbox-fade fade-in-warning"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.all,expression:"authorization.all"}],attrs:{type:"checkbox",disabled:t.oldGroup&&!t.onEdit},domProps:{checked:Array.isArray(e.all)?t._i(e.all,null)>-1:e.all},on:{change:[function(i){var o=e.all,s=i.target,a=!!s.checked;if(Array.isArray(o)){var n=t._i(o,null);s.checked?n<0&&t.$set(e,"all",o.concat([null])):n>-1&&t.$set(e,"all",o.slice(0,n).concat(o.slice(n+1)))}else t.$set(e,"all",a)},function(i){return t.childrenModelGP(e)}]}}),t._v(" "),t._m(1,!0),t._v(" "),i("span",[i("small",[t._v(t._s(e.name))])])])])]),t._v(" "),i("span",{staticClass:"text-muted"},[t._v(t._s(e.description))]),t._v(" "),i("div",{staticClass:"form-row m-t-20"},[i("div",{staticClass:"col-lg-6"},[i("h4",{staticClass:"sub-title"},[t._v("Gates")]),t._v(" "),t._l(e.gates,(function(o){return i("div",{staticClass:"checkbox-fade fade-in-primary"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:o.value,expression:"gate.value"}],attrs:{type:"checkbox",disabled:t.oldGroup&&!t.onEdit},domProps:{checked:Array.isArray(o.value)?t._i(o.value,null)>-1:o.value},on:{change:[function(e){var i=o.value,s=e.target,a=!!s.checked;if(Array.isArray(i)){var n=t._i(i,null);s.checked?n<0&&t.$set(o,"value",i.concat([null])):n>-1&&t.$set(o,"value",i.slice(0,n).concat(i.slice(n+1)))}else t.$set(o,"value",a)},function(i){return t.parentGP(e)}]}}),t._v(" "),t._m(2,!0),t._v(" "),i("span",[t._v(" "+t._s(o.label))])])])}))],2),t._v(" "),i("div",{staticClass:"col-lg-6"},[i("h4",{staticClass:"sub-title"},[t._v("Policies")]),t._v(" "),t._l(e.policies,(function(o){return i("div",{staticClass:"checkbox-fade fade-in-danger"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:o.value,expression:"policy.value"}],attrs:{type:"checkbox",disabled:t.oldGroup&&!t.onEdit},domProps:{checked:Array.isArray(o.value)?t._i(o.value,null)>-1:o.value},on:{change:[function(e){var i=o.value,s=e.target,a=!!s.checked;if(Array.isArray(i)){var n=t._i(i,null);s.checked?n<0&&t.$set(o,"value",i.concat([null])):n>-1&&t.$set(o,"value",i.slice(0,n).concat(i.slice(n+1)))}else t.$set(o,"value",a)},function(i){return t.parentGP(e)}]}}),t._v(" "),t._m(3,!0),t._v(" "),i("span",[t._v(" "+t._s(o.label))])])])}))],2)])])})),t._v(" "),i("div",{staticClass:"f-right"},[t.oldGroup?t._e():i("button",{staticClass:"btn btn-info btn-sm",attrs:{type:"button"},on:{click:t.confirmAdd}},[t._v("Save")]),t._v(" "),t.oldGroup?i("button",{staticClass:"btn btn-info btn-sm",attrs:{type:"button",disabled:!t.onEdit},on:{click:t.confirmUpdate}},[t._v("Update")]):t._e(),t._v(" "),i("button",{staticClass:"btn btn-warning btn-sm",attrs:{type:"button"},on:{click:t.close}},[t._v(t._s(t.oldGroup?"Close":"Cancel"))])])],2)])])])],1),t._v(" "),i("b-modal",{ref:"confirm-add",attrs:{title:"Confirmation"},on:{ok:t.save}},[t._v("\n\t\tConfirm group add?\n\t")]),t._v(" "),i("b-modal",{ref:"confirm-update",attrs:{title:"Confirmation"},on:{ok:t.update}},[t._v("\n\t\tAre you sure you want to update this group's info?\n\t")]),t._v(" "),i("b-modal",{ref:"confirm-delete",attrs:{title:"Confirmation"},on:{ok:t.deleteGroup}},[t._v("\n\t\tAre you sure you want to delete this group?\n\t")])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cr"},[e("i",{staticClass:"cr-icon icofont icofont-ui-check txt-warning"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cr"},[e("i",{staticClass:"cr-icon icofont icofont-ui-check txt-warning"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cr"},[e("i",{staticClass:"cr-icon icofont icofont-ui-check txt-warning"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"cr"},[e("i",{staticClass:"cr-icon icofont icofont-ui-check txt-warning"})])}],!1,null,null,null);e.default=G.exports},iVL7:function(t,e,i){"use strict";i.r(e);var o={props:["isList"]},s=i("KHd+"),a=Object(s.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-header"},[i("div",{staticClass:"row align-items-end"},[t._m(0),t._v(" "),i("div",{staticClass:"col-lg-4"},[i("div",{staticClass:"page-header-breadcrumb"},[i("ul",{staticClass:"breadcrumb-title"},[i("li",{staticClass:"breadcrumb-item"},[i("router-link",{attrs:{to:"/dashboard"}},[i("i",{staticClass:"feather icon-home"})])],1),t._v(" "),t._m(1)])])])]),t._v(" "),t.isList?i("div",{staticClass:"row align-items-end"},[i("div",{staticClass:"col-lg-12"},[i("div",{staticStyle:{"margin-top":"20px"}},[i("router-link",{staticClass:"btn btn-primary btn-sm",attrs:{to:"/group",tag:"button"}},[t._v("Add")])],1)])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-lg-8"},[e("div",{staticClass:"page-header-title"},[e("div",{staticClass:"d-inline"},[e("h4",[this._v("Manage Groups")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"breadcrumb-item"},[e("a",{attrs:{href:"javascript:;"}},[this._v("Groups")])])}],!1,null,null,null);e.default=a.exports}}]);